(window.webpackJsonp=window.webpackJsonp||[]).push([[187],{737:function(e,t,s){"use strict";s.r(t);var n=s(0),a=Object(n.a)({},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"content"},[e._m(0),e._v(" "),s("p",[e._v("This binding allows to check, whether a device is currently available on the network.\nThis happens by either using "),s("a",{attrs:{href:"https://en.wikipedia.org/wiki/Ping_%28networking_utility%29",target:"_blank",rel:"noopener noreferrer"}},[e._v("ping"),s("OutboundLink")],1),e._v(" or by a successful TCP connection on a port of your choice.")]),e._v(" "),e._m(1),e._v(" "),s("p",[e._v("You can use the following configuration options:")]),e._v(" "),e._m(2),e._v(" "),e._m(3),e._v(" "),e._m(4),e._m(5),e._v(" "),e._m(6),e._v(" "),e._m(7),e._v(" "),e._m(8),e._v(" "),s("p",[e._v("Please note: things discovered by the network binding will be provided with a time to live (TTL) and will automatically disappear from the Inbox after 10 minutes.")]),e._v(" "),e._m(9),e._v(" "),e._m(10),e._m(11),e._v(" "),e._m(12),e._v(" "),e._m(13),e._v(" "),e._m(14),e._v(" "),e._m(15),e._v(" "),s("p",[e._v("You may need to configure devices to be reachable.\nA device may not answer ping requests by default.\nThis is the case with Windows 10 equipped systems or Android and iOS devices in deep sleep mode.")]),e._v(" "),e._m(16),e._v(" "),s("p",[e._v('Pings on windows 10 are usually blocked by the internal firewall.\nYou need to allow "Echo Request for ICMPv4" to allow your windows to respond to pings.')]),e._v(" "),e._m(17),e._v(" "),s("p",[e._v('Because mobile devices put themselves in a deep sleep mode after some inactivity, they do not react to normal ICMP pings.\nConfigure ARP ping to realize presence detection for those devices.\nThis only works if your devices have WIFI enabled, have been configured to use your home WIFI network, and have the option "Disable wifi in standby" disabled (default).\nAn almost immediate presence detection for phones and tables, if they (re)join the home Wifi network, is to use DHCP listen.')]),e._v(" "),e._m(18),e._v(" "),e._m(19),e._v(" "),e._m(20),e._v(" "),e._m(21),e._v(" "),e._m(22),s("p",[e._v("In this example, there are four suitable ports to use.\nThe port 554 (Windows network file sharing service) is open on most Windows PCs and Windows compatible Linux systems.\nPort 1025 (MS RPC) is open on XBox systems. Port 548 (Apple Filing Protocol (AFP)) is open on Mac OS X systems.")]),e._v(" "),s("p",[e._v("Please don't forget to open the required ports in your firewall setup.")]),e._v(" "),e._m(23),e._v(" "),s("p",[e._v("Because we use external tools for some of the presence detection mechanism or need elevated permissions for others, your OpenHAB installation needs to be altered.")]),e._v(" "),e._m(24),e._v(" "),s("p",[e._v('For arp pings to work, you need a separate tool, called "arping".\nOn Linux there exists three different tools:')]),e._v(" "),e._m(25),e._v(" "),s("p",[e._v("arping by Thomas Habets runs on Windows and MacOS as well.")]),e._v(" "),s("p",[e._v("Make sure the tool is available in $PATH (%PATH% respectively on Windows) or in the same path as the openHAB executable.")]),e._v(" "),e._m(26),e._v(" "),e._m(27),e._v(" "),s("p",[e._v('If devices leave and reenter a network, they usually request their last IPv4 address by using DHCP requests.\nIf we listen for those messages, we can make the status update more "real-time" and do not have to wait for the next refresh cycle.')]),e._v(" "),e._m(28),e._v(" "),e._m(29),s("p",[e._v("If you operate a DHCP server on port 67, you need to duplicate the received traffic and\nforward it to port 6767:")]),e._v(" "),e._m(30),e._m(31),e._v(" "),s("p",[e._v("Things support the following channels:")]),e._v(" "),e._m(32),e._v(" "),e._m(33),e._v(" "),s("p",[e._v("demo.things:")]),e._v(" "),e._m(34),s("p",[e._v("demo.items:")]),e._v(" "),e._m(35),s("p",[e._v("demo.sitemap:")]),e._v(" "),e._m(36),s("DocPreviousVersions"),e._v(" "),s("EditPageLink")],1)},[function(){var e=this.$createElement,t=this._self._c||e;return t("h1",{attrs:{id:"network-binding"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#network-binding","aria-hidden":"true"}},[this._v("#")]),this._v(" Network Binding")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"binding-configuration"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#binding-configuration","aria-hidden":"true"}},[this._v("#")]),this._v(" Binding configuration")])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ul",[s("li",[s("strong",[e._v("allowSystemPings:")]),e._v(" Use the external ICMP ping program of the operating system, instead of the Java ping. Useful if the devices cannot be reached by Java ping. Default is true.")]),e._v(" "),s("li",[s("strong",[e._v("allowDHCPlisten:")]),e._v('  If devices leave and reenter a network, they usually request their last IPv4 address by using DHCP requests. If we listen for those messages, we can make the status update more "real-time" and do not have to wait for the next refresh cycle. Default is true.')]),e._v(" "),s("li",[s("strong",[e._v("arpPingToolPath:")]),e._v(' If your arp ping tool is not called arping and cannot be found in the PATH environment, you can configure the absolute path here. Default is "arping".')]),e._v(" "),s("li",[s("strong",[e._v("cacheDeviceStateTimeInMS:")]),e._v(" The result of a device presence detection is cached for a small amount of time. Set this time here in milliseconds. Be aware that no new pings will be issued within this time frame, even if explicitly requested. Default is 2000.")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("Create a file "),t("em",[this._v("org.openHAB.binding.network.cfg")]),this._v(" in your openHAB/etc directory and use the above options like this:")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("allowSystemPings=false\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"supported-things"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#supported-things","aria-hidden":"true"}},[this._v("#")]),this._v(" Supported Things")])},function(){var e=this.$createElement,t=this._self._c||e;return t("ul",[t("li",[t("strong",[this._v("pingdevice:")]),this._v(" Detects device presence by using icmp pings, arp pings and dhcp packet sniffing.")]),this._v(" "),t("li",[t("strong",[this._v("servicedevice:")]),this._v(" Detects device presence by scanning for a specific open tcp port.")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"discovery"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#discovery","aria-hidden":"true"}},[this._v("#")]),this._v(" Discovery")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("Auto discovery can be used to scan the local network for "),t("strong",[this._v("pingdevice")]),this._v(" things by sending a ping to every IP on the network.\nSome network tools will identify this as a network intruder alarm, therefore automatic background discovery is disabled and a manual scan needs to be issued.")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"thing-configuration"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#thing-configuration","aria-hidden":"true"}},[this._v("#")]),this._v(" Thing Configuration")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v('network:pingdevice:one_device [ hostname="192.168.0.64" ]\n\nnetwork:pingdevice:second_device [ hostname="192.168.0.65", retry=1, timeout=5000, refreshInterval=60000 ]\n\nnetwork:servicedevice:important_server [ hostname="192.168.0.62", port=1234 ]\n')])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("Use the following options for a "),t("strong",[this._v("network:pingdevice")]),this._v(":")])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ul",[s("li",[s("strong",[e._v("hostname:")]),e._v(" IP address or hostname of the device")]),e._v(" "),s("li",[s("strong",[e._v("retry:")]),e._v(" After how many refresh interval cycles shall the device be assumed as offline. Default is 1.")]),e._v(" "),s("li",[s("strong",[e._v("timeout:")]),e._v(" How long shall the ping wait for an answer (in milliseconds. Default: "),s("code",[e._v("5000")]),e._v(" = 5 seconds)")]),e._v(" "),s("li",[s("strong",[e._v("refreshInterval:")]),e._v(" How often shall the device be checked (in milliseconds. Default: "),s("code",[e._v("60000")]),e._v(" = one minute)")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("Use the following additional options for a "),t("strong",[this._v("network:servicedevice")]),this._v(":")])},function(){var e=this.$createElement,t=this._self._c||e;return t("ul",[t("li",[t("strong",[this._v("port:")]),this._v(" Must not be 0. The destination port needs to be a TCP service.")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"presence-detection-configure-target-device"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#presence-detection-configure-target-device","aria-hidden":"true"}},[this._v("#")]),this._v(" Presence detection - Configure target device")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"respond-to-pings-on-windows-10"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#respond-to-pings-on-windows-10","aria-hidden":"true"}},[this._v("#")]),this._v(" Respond to pings on Windows 10+")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"android-and-ios-devices"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#android-and-ios-devices","aria-hidden":"true"}},[this._v("#")]),this._v(" Android and iOS devices")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"iphones-ipads"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#iphones-ipads","aria-hidden":"true"}},[this._v("#")]),this._v(" iPhones, iPads")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("Apple iOS devices are usually in a deep sleep mode and do not respond to ARP pings under all conditions, but to Bonjour service discovery messages (UDP port 5353).\nTherefore first a Bonjour message is send, before the ARP presence detection is performed.\nThe binding automatically figures out if the target device is an iOS device.\nYou can check if the binding has correctly recognised your device by having a look at the "),t("em",[this._v("uses_ios_wakeup")]),this._v(" property of your thing.\nAn almost immediate presence detection for phones and tables, if they (re)join the home Wifi network, is to use DHCP listen.")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"use-open-tcp-ports"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#use-open-tcp-ports","aria-hidden":"true"}},[this._v("#")]),this._v(" Use open TCP ports")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("Many devices provide services on TCP ports (web-frontends, streaming servers, ...), which you can use to confirm there presence in the network.\nMost operating systems have options to list open ports.\nOn a linux-based system, you may use "),t("em",[this._v("nmap")]),this._v(" to discover all open TCP ports on the device with the specified IP address:")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("$ sudo nmap -Pn -sT -p- 192.168.0.42\n\nStarting Nmap 6.47 ( http://nmap.org ) at 2016-07-31 20:00 CEST\nNmap scan report for linuxPC (192.168.0.42)\nHost is up (0.0011s latency).\nNot shown: 65531 filtered ports\nPORT      STATE SERVICE\n554/tcp   open  rtsp\n8089/tcp  open  unknown\n8090/tcp  open  unknown\n8889/tcp  open  ddi-tcp-2\n\nNmap done: 1 IP address (1 host up) scanned in 106.17 seconds\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"presence-detection-configure-your-openhab-installation"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#presence-detection-configure-your-openhab-installation","aria-hidden":"true"}},[this._v("#")]),this._v(" Presence detection - Configure your openHAB installation")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"arping"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#arping","aria-hidden":"true"}},[this._v("#")]),this._v(" Arping")])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ul",[s("li",[e._v("arp-scan (not yet supported by this binding)")]),e._v(" "),s("li",[e._v("arping of the ip-utils (Ubuntu/Debian: "),s("code",[e._v("apt-get install iputils-arping")]),e._v(")")]),e._v(" "),s("li",[e._v("arping by Thomas Habets (Ubuntu/Debian: "),s("code",[e._v("apt-get install arping")]),e._v(")")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("On Linux and MacOS you might need elevated access permissions, for instance by making the executable a suid executable ("),t("code",[this._v("chmod u+s /usr/sbin/arping")]),this._v(").\nJust test the executable on the command line, if "),t("code",[this._v("sudo")]),this._v(" is required, you need to grant elevated permissions.")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"dhcp-listen"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#dhcp-listen","aria-hidden":"true"}},[this._v("#")]),this._v(" DHCP Listen")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("Some operating systems such as Linux restrict applications to only use ports >= 1024 without elevated privileges.\nIf the binding is not able to use port 67 (DHCP), because of such a restriction or because the same system is used as a DHCP server, port 6767 will be used instead.\nCheck the property "),t("em",[this._v("dhcp_state")]),this._v(" on your thing for such a hint. You need to establish a port forwarding in this case:")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[this._v("sysctl -w net.ipv4.ip_forward"),t("span",{attrs:{class:"token operator"}},[this._v("=")]),this._v("1\niptables -A INPUT -p udp --dport 6767 -j ACCEPT\niptables -t nat -A PREROUTING -p udp --dport 67 -j REDIRECT --to-ports 6767\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[this._v("iptables -A PREROUTING -t mangle -p udp "),t("span",{attrs:{class:"token operator"}},[this._v("!")]),this._v(" -s 127.0.0.1 --dport 67 -j TEE --gateway 127.0.0.1\niptables -A OUTPUT -t nat -p udp -s 127.0.0.1/32 --dport 67 -j DNAT --to 127.0.0.1:6767\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"channels"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#channels","aria-hidden":"true"}},[this._v("#")]),this._v(" Channels")])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("table",[s("thead",[s("tr",[s("th",[e._v("Channel Type ID")]),e._v(" "),s("th",[e._v("Item Type")]),e._v(" "),s("th",[e._v("Description")])])]),e._v(" "),s("tbody",[s("tr",[s("td",[e._v("online")]),e._v(" "),s("td",[e._v("Switch")]),e._v(" "),s("td",[e._v("This channel indicates whether a device is online or not")])]),e._v(" "),s("tr",[s("td",[e._v("lastseen")]),e._v(" "),s("td",[e._v("DateTime")]),e._v(" "),s("td",[e._v("The last seen date/time of the device in question. May be 1. Jan 1970 if no time is known.")])]),e._v(" "),s("tr",[s("td",[e._v("latency")]),e._v(" "),s("td",[e._v("Number")]),e._v(" "),s("td",[e._v("This channel indicates the ping latency in milliseconds. May be 0 if no time is known.")])])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"example"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#example","aria-hidden":"true"}},[this._v("#")]),this._v(" Example")])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"language-xtend extra-class"},[s("pre",{pre:!0,attrs:{class:"language-dsl"}},[s("code",[s("span",{attrs:{class:"token keyword"}},[e._v("Thing")]),e._v(" "),s("span",{attrs:{class:"token class-name"}},[e._v("network"),s("span",{attrs:{class:"token punctuation"}},[e._v(":")]),e._v("pingdevice"),s("span",{attrs:{class:"token punctuation"}},[e._v(":")]),e._v("devicename")]),e._v(" "),s("span",{attrs:{class:"token punctuation"}},[e._v("[")]),e._v(" hostname"),s("span",{attrs:{class:"token operator"}},[e._v("=")]),s("span",{attrs:{class:"token string"}},[e._v('"192.168.0.42"')]),e._v(" "),s("span",{attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n")])])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"language-xtend extra-class"},[s("pre",{pre:!0,attrs:{class:"language-dsl"}},[s("code",[s("span",{attrs:{class:"token keyword"}},[e._v("Switch")]),e._v(" "),s("span",{attrs:{class:"token class-name"}},[e._v("MyDevice")]),e._v(" "),s("span",{attrs:{class:"token punctuation"}},[e._v("{")]),e._v(" channel"),s("span",{attrs:{class:"token operator"}},[e._v("=")]),s("span",{attrs:{class:"token string"}},[e._v('"network:pingdevice:devicename:online"')]),e._v(" "),s("span",{attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n"),s("span",{attrs:{class:"token keyword"}},[e._v("Number")]),e._v(" "),s("span",{attrs:{class:"token class-name"}},[e._v("MyDeviceResponseTime")]),e._v(" "),s("span",{attrs:{class:"token punctuation"}},[e._v("{")]),e._v(" channel"),s("span",{attrs:{class:"token operator"}},[e._v("=")]),s("span",{attrs:{class:"token string"}},[e._v('"network:pingdevice:devicename:latency"')]),e._v(" "),s("span",{attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"language-xtend extra-class"},[s("pre",{pre:!0,attrs:{class:"language-dsl"}},[s("code",[s("span",{attrs:{class:"token keyword"}},[e._v("sitemap")]),e._v(" demo "),s("span",{attrs:{class:"token constant"}},[e._v("label")]),s("span",{attrs:{class:"token operator"}},[e._v("=")]),s("span",{attrs:{class:"token string"}},[e._v('"Main Menu"')]),e._v("\n"),s("span",{attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n\t"),s("span",{attrs:{class:"token keyword"}},[e._v("Frame")]),e._v(" "),s("span",{attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n\t\t"),s("span",{attrs:{class:"token keyword"}},[e._v("Text")]),e._v(" "),s("span",{attrs:{class:"token class-name"}},[e._v("item")]),s("span",{attrs:{class:"token operator"}},[e._v("=")]),e._v("MyDevice "),s("span",{attrs:{class:"token constant"}},[e._v("label")]),s("span",{attrs:{class:"token operator"}},[e._v("=")]),s("span",{attrs:{class:"token string"}},[e._v('"Device [%s]"')]),e._v("\n\t\t"),s("span",{attrs:{class:"token keyword"}},[e._v("Text")]),e._v(" "),s("span",{attrs:{class:"token class-name"}},[e._v("item")]),s("span",{attrs:{class:"token operator"}},[e._v("=")]),e._v("MyDeviceResponseTime "),s("span",{attrs:{class:"token constant"}},[e._v("label")]),s("span",{attrs:{class:"token operator"}},[e._v("=")]),s("span",{attrs:{class:"token string"}},[e._v('"Device Response Time [%s]"')]),e._v("\n\t"),s("span",{attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n"),s("span",{attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])])}],!1,null,null,null);a.options.__file="readme.md";t.default=a.exports}}]);