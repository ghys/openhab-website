(window.webpackJsonp=window.webpackJsonp||[]).push([[297],{687:function(e,t,n){"use strict";n.r(t);var r=n(0),i=Object(r.a)({},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"content"},[e._m(0),e._v(" "),n("AddonLogo"),e._v(" "),n("p",[e._v("This service will synchronize files on the openHAB server, such as configuration and log files, to and/or from a Dropbox account.")]),e._v(" "),n("p",[e._v("The main use case is backing up openHAB configuration and log files\nto a version-able cloud space and transporting changed files back to openHAB\nafter editing them with the openHAB Designer on the administrator's desktop PC.")]),e._v(" "),e._m(1),e._v(" "),e._m(2),e._v(" "),e._m(3),e._v(" "),e._m(4),e._v(" "),e._m(5),e._v(" "),e._m(6),e._v(" "),e._m(7),e._v(" "),e._m(8),e._v(" "),n("table",[e._m(9),e._v(" "),n("tbody",[e._m(10),e._v(" "),e._m(11),e._v(" "),n("tr",[n("td",[e._v("uploadInterval")]),e._v(" "),e._m(12),e._v(" "),n("td",{staticStyle:{"text-align":"center"}},[e._v("No")]),e._v(" "),n("td",[e._v("a "),n("a",{attrs:{href:"http://quartz-scheduler.org/documentation/quartz-2.1.x/tutorials/tutorial-lesson-06",target:"_blank",rel:"noopener noreferrer"}},[e._v("cron expression"),n("OutboundLink")],1),e._v(" to set the schedule for uploading changes to Dropbox.  The default schedule uploads changes every day at 2am.")])]),e._v(" "),n("tr",[n("td",[e._v("downloadInterval")]),e._v(" "),e._m(13),e._v(" "),n("td",{staticStyle:{"text-align":"center"}},[e._v("No")]),e._v(" "),n("td",[e._v("a "),n("a",{attrs:{href:"http://quartz-scheduler.org/documentation/quartz-2.1.x/tutorials/tutorial-lesson-06",target:"_blank",rel:"noopener noreferrer"}},[e._v("cron expression"),n("OutboundLink")],1),e._v(" to set the schedule for downloading changes from Dropbox.  The default schedule downloads any changes every five minutes.")])]),e._v(" "),e._m(14),e._v(" "),e._m(15),e._v(" "),e._m(16)])]),e._v(" "),e._m(17),e._v(" "),n("p",[e._v("An app must be created on Dropbox.")]),e._v(" "),e._m(18),e._v(" "),n("ul",[n("li",[e._v("Create an account in "),n("a",{attrs:{href:"http://www.dropbox.com",target:"_blank",rel:"noopener noreferrer"}},[e._v("Dropbox"),n("OutboundLink")],1)]),e._v(" "),n("li",[e._v("Navigate to the "),n("a",{attrs:{href:"http://www.dropbox.com/developers",target:"_blank",rel:"noopener noreferrer"}},[e._v("developer section of the site"),n("OutboundLink")],1)]),e._v(" "),n("li",[e._v('Click the "My apps" link in the left navigation menu, then click the "Create app" button')]),e._v(" "),n("li",[e._v('In the next screen, select "Dropbox API" in step 1')]),e._v(" "),n("li",[e._v('Select "Full Dropbox" in step 2 (This is probably not critical, as "App folder" may also work, but this has not been tested)')]),e._v(" "),n("li",[e._v('Choose a name for your app in step 3 and click "Create app"')]),e._v(" "),n("li",[e._v('The following screen will summarize your app; verify the "Allow implicit grant" setting is set to "Allow"')]),e._v(" "),n("li",[e._v('Under the heading that says "Generated access token", click the "Generate" button to generate an access token that openHAB can use to connect with your app')]),e._v(" "),e._m(19)]),e._v(" "),n("p",[n("a",{attrs:{href:"http://www.iperiusbackup.net/en/create-dropbox-app-get-authentication-token/",target:"_blank",rel:"noopener noreferrer"}},[e._v("This tutorial"),n("OutboundLink")],1),e._v("\nalso contains a video of the process.")]),e._v(" "),e._m(20),e._v(" "),n("p",[e._v("Installations that used the Dropbox Synchronization Service in earlier versions\nof openHAB may encounter this error:")]),e._v(" "),e._m(21),e._v(" "),e._m(22),e._v(" "),e._m(23),e._v(" "),n("p",[e._v("This is a three-step process. openHAB requests a token which is used as a\none-time-password to obtain an access token which will be used for all future\nrequests to Dropbox.")]),e._v(" "),e._m(24),e._v(" "),n("p",[e._v("The following message will be sent to the log on first startup:")]),e._v(" "),e._m(25),e._m(26),e._v(" "),n("p",[e._v("Copy the given URL to your browser and authorize openHAB to use Dropbox in\nthe future. Be aware that the request token is only valid for the next five\nminutes.")]),e._v(" "),n("p",[e._v("After successful authorization, a token is shown on the Dropbox web page:")]),e._v(" "),e._m(27),e._v(" "),e._m(28),e._v(" "),e._m(29),e._v(" "),e._m(30),e._m(31),e._v(" "),n("p",[e._v("Copy the token shown on the Dropbox web page and issue the following command:")]),e._v(" "),e._m(32),n("DocPreviousVersions"),e._v(" "),n("EditPageLink")],1)},[function(){var e=this.$createElement,t=this._self._c||e;return t("h1",{attrs:{id:"dropbox-synchronization-service"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#dropbox-synchronization-service","aria-hidden":"true"}},[this._v("#")]),this._v(" Dropbox Synchronization Service")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"service-configuration"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#service-configuration","aria-hidden":"true"}},[this._v("#")]),this._v(" Service Configuration")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("This service can be configured in the file "),t("code",[this._v("services/dropbox.cfg")]),this._v(".")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"authentication-settings"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#authentication-settings","aria-hidden":"true"}},[this._v("#")]),this._v(" Authentication settings")])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("table",[n("thead",[n("tr",[n("th",[e._v("Property")]),e._v(" "),n("th",[e._v("Default")]),e._v(" "),n("th",{staticStyle:{"text-align":"center"}},[e._v("Required")]),e._v(" "),n("th",[e._v("Description")])])]),e._v(" "),n("tbody",[n("tr",[n("td",[e._v("personalAccessToken")]),e._v(" "),n("td"),e._v(" "),n("td",{staticStyle:{"text-align":"center"}},[e._v("Yes*")]),e._v(" "),n("td",[e._v("The generated access token")])]),e._v(" "),n("tr",[n("td",[e._v("appkey")]),e._v(" "),n("td"),e._v(" "),n("td",{staticStyle:{"text-align":"center"}},[e._v("Yes*")]),e._v(" "),n("td",[e._v("A valid appkey")])]),e._v(" "),n("tr",[n("td",[e._v("appsecret")]),e._v(" "),n("td"),e._v(" "),n("td",{staticStyle:{"text-align":"center"}},[e._v("Yes*")]),e._v(" "),n("td",[e._v("A valid appsecret")])])])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",[e._v("* In order to authenticate with Dropbox, the configuration must include\n"),n("strong",[e._v("either")]),e._v(" the "),n("code",[e._v("personalAccessToken")]),e._v(" or "),n("strong",[e._v("BOTH")]),e._v(" the "),n("code",[e._v("appkey")]),e._v(" AND the\n"),n("code",[e._v("appsecret")]),e._v(".")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("The "),t("code",[this._v("personalAccessToken")]),this._v(" is the newer method of authentication, and is\na simpler process, but the "),t("code",[this._v("appkey")]),this._v("/"),t("code",[this._v("appsecret")]),this._v(" method would theoretically\nwork if configured.")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("If all three properties are defined in the configuration, the\n"),t("code",[this._v("personalAccessToken")]),this._v(" method will be used and the others ignored.")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"general-settings"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#general-settings","aria-hidden":"true"}},[this._v("#")]),this._v(" General settings")])},function(){var e=this.$createElement,t=this._self._c||e;return t("thead",[t("tr",[t("th",[this._v("Property")]),this._v(" "),t("th",[this._v("Default")]),this._v(" "),t("th",{staticStyle:{"text-align":"center"}},[this._v("Required")]),this._v(" "),t("th",[this._v("Description")])])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("tr",[n("td",[e._v("fakemode")]),e._v(" "),n("td",[n("code",[e._v("false")])]),e._v(" "),n("td",{staticStyle:{"text-align":"center"}},[e._v("No")]),e._v(" "),n("td",[e._v("operates the synchronizer in fake mode which avoids sending files to or from Dropbox. Set to "),n("code",[e._v("true")]),e._v(" as a test mode for the filter settings.")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("tr",[t("td",[this._v("contentdir")]),this._v(" "),t("td",[this._v("openHAB configuration directory")]),this._v(" "),t("td",{staticStyle:{"text-align":"center"}},[this._v("No")]),this._v(" "),t("td",[this._v("the base directory to synchronize with openHAB")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("td",[t("code",[this._v("0 0 2 * * ?")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("td",[t("code",[this._v("0 0/5 * * * ?")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("tr",[n("td",[e._v("syncmode")]),e._v(" "),n("td",[n("code",[e._v("LOCAL_TO_DROPBOX")])]),e._v(" "),n("td",{staticStyle:{"text-align":"center"}},[e._v("No")]),e._v(" "),n("td",[e._v("There are three different synchronization modes available:"),n("br"),n("br"),n("code",[e._v("DROPBOX_TO_LOCAL")]),e._v(" - changed files will be downloaded from your Dropbox to openHAB only"),n("br"),n("code",[e._v("LOCAL_TO_DROPBOX")]),e._v(" - locally changed files will be uploaded to your Dropbox only"),n("br"),n("code",[e._v("BIDIRECTIONAL")]),e._v(" - files will be synchronized from Dropbox to your local openHAB and vice versa. All changes will be downloaded from Dropbox to your local system first. After that any local changes will be uploaded to Dropbox. Hence a concurrent change to one file will be overruled by Dropbox in any case."),n("br"),n("br"),e._v("In case your Dropbox returns the "),n("code",[e._v("reset")]),e._v(" flag, all local files will be uploaded to your Dropbox once, even if your synchronization mode is set to "),n("code",[e._v("DROPBOX_TO_LOCAL")]),e._v(". The "),n("code",[e._v("reset")]),e._v(" flag might be returned either if the synchronization has been the first call ever (so no delta cursor is available) or there might be technical issues at Dropbox which causes the connected clients to resynchronize their states with Dropbox again.")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("tr",[t("td",[this._v("uploadfilter")]),this._v(" "),t("td",[t("code",[this._v("^([^/]*/){1}[^/]*$,/configurations.*,/logs/.*,/etc/.*")])]),this._v(" "),t("td",{staticStyle:{"text-align":"center"}},[this._v("No")]),this._v(" "),t("td",[this._v("The defaults are specific to openHAB 1.x running on Unix-like systems")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("tr",[t("td",[this._v("downloadfilter")]),this._v(" "),t("td",[t("code",[this._v("^([^/]*/){1}[^/]*$,/configurations.*")])]),this._v(" "),t("td",{staticStyle:{"text-align":"center"}},[this._v("No")]),this._v(" "),t("td",[this._v("The defaults are specific to openHAB 1.x running on Unix-like systems")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"dropbox-app"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#dropbox-app","aria-hidden":"true"}},[this._v("#")]),this._v(" Dropbox App")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"creating-an-app"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#creating-an-app","aria-hidden":"true"}},[this._v("#")]),this._v(" Creating an app")])},function(){var e=this.$createElement,t=this._self._c||e;return t("li",[this._v("Copy the long code string that is generated and paste it into the openHAB configuration file as the value for the "),t("code",[this._v("personalAccessToken")]),this._v(" setting shown above")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"troubleshooting"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#troubleshooting","aria-hidden":"true"}},[this._v("#")]),this._v(" Troubleshooting")])},function(){var e=this.$createElement,t=this._self._c||e;return t("blockquote",[t("p",[this._v('[WARN ] [d.internal.DropboxSynchronizer] - Synchronizing data with Dropbox throws an exception: {"error": "Invalid "cursor" parameter: this cursor is for a different app."}')])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("To eliminate this error, delete the "),t("code",[this._v("deltacursor.dbx")]),this._v(" file. It should be in the same folder as the openHAB startup scripts.")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"authentication-via-appkey-appsecret"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#authentication-via-appkey-appsecret","aria-hidden":"true"}},[this._v("#")]),this._v(" Authentication via appkey/appsecret")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"step-1-monitor-log-for-authorization-message"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#step-1-monitor-log-for-authorization-message","aria-hidden":"true"}},[this._v("#")]),this._v(" Step 1: Monitor Log for Authorization Message")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v(" #########################################################################################\n # Dropbox-Integration: U S E R   I N T E R A C T I O N   R E Q U I R E D !!\n # 1. Open URL 'https://www.dropbox.com/1/oauth2/_type=code'\n # 2. Allow openHAB to access Dropbox\n # 3. Paste the authorisation code here using the command 'dropbox:finishAuthentication \"<token>\"'\n #########################################################################################\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"step-2-obtain-authorization-token"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#step-2-obtain-authorization-token","aria-hidden":"true"}},[this._v("#")]),this._v(" Step 2: Obtain Authorization Token")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[t("img",{attrs:{src:"https://github.com/openhab/openhab1-addons/wiki/images/screenshots/dropbox-authorization.png",alt:""}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"step-3-save-token-in-openhab-console"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#step-3-save-token-in-openhab-console","aria-hidden":"true"}},[this._v("#")]),this._v(" Step 3: Save Token in openHAB Console")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("Access the openHAB console to reach the "),t("code",[this._v("openhab>")]),this._v(" prompt.  One way you can\naccess the openHAB 2 console:")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("ssh openhab@localhost -p 8101\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("The default password is "),t("code",[this._v("habopen")]),this._v(".  If this is the first time accessing your\nconsole, it may take some time to generate cryptographic keys.")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v('dropbox:finishAuthentication "replace with the token"\n')])])])}],!1,null,null,null);i.options.__file="readme.md";t.default=i.exports}}]);